language: php
php:
  - 5.2
  - 5.3
  - 5.4
  - 5.5
env:
  - DATABASE_DSN=pgsql:user=postgres
  - DATABASE_DSN=sqlite:$PWD/default.sqlite3
before_script:
  - echo "extension = xdebug.so" >> ~/.phpenv/versions/5.2/etc/php.ini
  - (cd cli; composer install)
  - (cd cli; vendor/bin/phpmig migrate)
script:
  - mkdir -p build/logs
  - phpunit
after_script:
  - (cd cli; vendor/bin/coveralls -v)
cache:
  directories:
    - vendor
    - dbmigrate/vendor
    - $HOME/.composer
